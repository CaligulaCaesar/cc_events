
namespace = cc_events_performance

#monthly
event = {
	id = cc_events_performance.1
	hide_window = yes
	is_triggered_only = yes
	
	immediate = {
		every_country = {
			if = {
				limit = {
					any_country = {
						OR = {
							is_hostile_to = prev
							is_rival = prev
							is_domineering_to = prev
						}
						relative_power = {
							who = prev
							category = fleet
							value = overwhelming
						}
					}
				}
				set_timed_country_flag = {
					flag = cc_eventperf_has_overwhelming_rival
					days = 31
				}
			}
			if = {
				limit = {
					any_country = {
						OR = {
							is_hostile_to = prev
							is_rival = prev
							is_domineering_to = prev
						}
						relative_power = {
							who = prev
							category = fleet
							value = superior
						}
					}
				}
				set_timed_country_flag = {
					flag = cc_eventperf_has_superior_rival
					days = 31
				}
			}
		}

		every_playable_country = {
			country_event = { id = cc_events_performance.11111 days = 10 }
		}
	}
}

country_event = {
	id = cc_events_performance.11111
	hide_window = yes
	is_triggered_only = yes
	
	immediate = {
		if = {
			limit = {

				num_owned_planets > 5
				NOT = { has_ethic = ethic_gestalt_consciousness }
				has_a_factional_revolt_active = no
				count_pop_factions = {
					limit = {
						OR = {
							is_pop_faction_type = imperialist
							is_pop_faction_type = isolationist
							is_pop_faction_type = progressive
							is_pop_faction_type = prosperity
							is_pop_faction_type = supremacist
							is_pop_faction_type = technologist
							is_pop_faction_type = totalitarian
							is_pop_faction_type = traditionalist
							is_pop_faction_type = xenoist
						}
						support > 0.15
						pop_percentage = {
							percentage > 0.74
							limit = { happiness < 0.4 }
						}
					}
					count > 0
				}
			}
			set_timed_country_flag = {
				flag = cc_potential_faction_revolt
				days = 31
			}
			if = {
				limit = {
					count_pop_factions = {
						limit = {
							is_a_vanilla_faction = yes
							support > 0.15
							pop_percentage = {
								percentage > 0.6
								limit = { happiness < 0.3 }
							}
						}
						count > 0
					}
				}
				set_timed_country_flag = {
					flag = cc_angry_faction_revolt
					days = 31
				}
			}
			if = {
				limit = {
					count_pop_factions = {
						limit = {
							is_a_vanilla_faction = yes
							support > 0.2
							pop_percentage = {
								percentage > 0.75
								limit = { happiness < 0.4 }
							}
						}
						count > 0
					}
				}
				set_timed_country_flag = {
					flag = cc_large_faction_revolt
					days = 31
				}
			}
		}
		
		#Prominent IM
		if = {
			limit = {
				NOT = { has_country_flag = cc_recent_prominent_IM }
				has_policy_flag = allows_im
				
				any_owned_pop = {
					NOR = {
						is_subspecies = prev
						is_same_species = prev
					}
					species = { pops_have_happiness = yes }
					NOR = {
						is_enslaved = yes
						is_being_purged = yes
					}
				}
				any_owned_leader = {
					NOR = {
						is_same_value = prev.ruler
						leader_of_faction = supremacist
						leader_of_faction = isolationist
						has_leader_flag = cc_married
					}
					is_same_species = prev
				}
			}
			set_timed_country_flag = {
				flag = cc_eventperf_PIM_possible
				days = 31
			}
		}
		
		
		#Xeno Sex Scandal
		if = {
			limit = {

				NOT = { has_ethic = ethic_gestalt_consciousness }
				NOT = { has_country_flag = cc_recent_sex_scandal }
		
				OR = {
					has_policy_flag = bans_im_completely
					has_ethic = ethic_xenophobe
					has_ethic = ethic_fanatic_xenophobe
				}
		
				any_owned_pop = {
					NOR = {
						is_subspecies = prev
						is_same_species = prev
						is_robot_pop = no
					}
					species = { pops_have_happiness = yes }
				}
			}
			set_timed_country_flag = {
				flag = cc_eventperf_xeno_sex_scandal_possible
				days = 31
			}
			every_owned_leader = {
				limit = { leader_of_faction = xenoist }
				set_timed_leader_flag = {
					flag = cc_xenoist_leader
					days = 31
				}
			}
		}
		#Factional Revolt Breakout
		if = {
			limit = {
				has_factional_revolt_stage3 = yes
				NOR = {
					has_country_flag = cc_factional_revolt_attempt
					has_country_flag = cc_factional_revolt_succeeded
				}
				any_owned_planet = {
					is_faction_stronghold = yes
					unrest > 80
					has_ground_combat = no
					exists = controller
					controller = { is_same_value = prev.owner }
					has_modifier = cc_faction_acute_unrest
				}
			}
			set_timed_country_flag = {
				flag = cc_factional_revolt_can_attempt
				days = 31
			}
			if = {
				limit = {
					any_owned_planet = {
						is_faction_stronghold = yes
						unrest > 99
						has_ground_combat = no
						exists = controller
						controller = { is_same_value = prev.owner }
						has_modifier = cc_faction_acute_unrest
					}
				}
				set_timed_country_flag = {
					flag = cc_factional_revolt_attempt_will_succeed
					days = 31
				}
			}
			if = {
				limit = {
					any_owned_planet = {
						is_faction_stronghold = yes
						unrest > 80
						has_ground_combat = no
						exists = controller
						controller = { is_same_value = prev.owner }
						has_modifier = cc_faction_acute_unrest
						
						owner = {
							any_owned_planet = {
								NOT = { is_same_value = prevprev }
								is_faction_stronghold = yes
								unrest > 80
								has_ground_combat = no
								exists = controller
								controller = { is_same_value = prev.owner }
								has_modifier = cc_faction_acute_unrest
								
								owner = {
									any_owned_planet = {
										NOR = {
											is_same_value = prevprev
											is_same_value = prevprevprevprev
										}
										is_faction_stronghold = yes
										unrest > 80
										has_ground_combat = no
										exists = controller
										controller = { is_same_value = prev.owner }
										has_modifier = cc_faction_acute_unrest
									}
								}
							}
						}
					}
				}
				set_timed_country_flag = {
					flag = cc_factional_revolt_attempt_3planets
					days = 31
				}
				if = {
					limit = {

						any_owned_planet = {
							is_faction_stronghold = yes
							unrest > 80
							has_ground_combat = no
							exists = controller
							controller = { is_same_value = prev.owner }
							has_modifier = cc_faction_acute_unrest
							
							owner = {
								any_owned_planet = {
									NOT = { is_same_value = prevprev }
									is_faction_stronghold = yes
									unrest > 80
									has_ground_combat = no
									exists = controller
									controller = { is_same_value = prev.owner }
									has_modifier = cc_faction_acute_unrest
									
									owner = {
										any_owned_planet = {
											NOR = {
												is_same_value = prevprev
												is_same_value = prevprevprevprev
											}
											is_faction_stronghold = yes
											unrest > 80
											has_ground_combat = no
											exists = controller
											controller = { is_same_value = prev.owner }
											has_modifier = cc_faction_acute_unrest
											owner = {
												any_owned_planet = {
													NOR = {
														is_same_value = prevprev
														is_same_value = prevprevprevprev
														is_same_value = prevprevprevprev.prevprev
													}
													is_faction_stronghold = yes
													unrest > 80
													has_ground_combat = no
													exists = controller
													controller = { is_same_value = prev.owner }
													has_modifier = cc_faction_acute_unrest
													owner = {
														any_owned_planet = {
															NOR = {
																is_same_value = prevprev
																is_same_value = prevprevprevprev
																is_same_value = prevprevprevprev.prevprev
																is_same_value = prevprevprevprev.prevprevprev
															}
															is_faction_stronghold = yes
															unrest > 80
															has_ground_combat = no
															exists = controller
															controller = { is_same_value = prev.owner }
															has_modifier = cc_faction_acute_unrest
														}
													}
												}
											}
										}
									}
								}
							}
						}
					}
					set_timed_country_flag = {
						flag = cc_factional_revolt_attempt_5planets
						days = 31
					}
				}
			}
		}
		
		
		#corruption_scandal
		if = {
			limit = {

				NOT = { has_ethic = ethic_gestalt_consciousness }
				
				OR = {
					has_monthly_income = {
						resource = minerals
						value > 250
					}
					has_monthly_income = {
						resource = energy
						value > 250
					}
				}
			}
			set_timed_country_flag = {
				flag = dpe_can_have_corruption_scandal
				days = 31
			}
			if = {
				limit = {
					OR = {
						has_monthly_income = {
							resource = minerals
							value > 500
						}
						has_monthly_income = {
							resource = energy
							value > 500
						}
					}
				}
				set_timed_country_flag = {
					flag = dpe_corruption_scandal_more_likely
					days = 31
				}
				if = {
					limit = {
						OR = {
							has_monthly_income = {
								resource = minerals
								value > 750
							}
							has_monthly_income = {
								resource = energy
								value > 750
							}
						}
					}
					set_timed_country_flag = {
						flag = dpe_corruption_scandal_likely
						days = 31
					}
					if = {
						limit = {
							OR = {
								has_monthly_income = {
									resource = minerals
									value > 1000
								}
								has_monthly_income = {
									resource = energy
									value > 1000
								}
							}
						}
						set_timed_country_flag = {
							flag = dpe_corruption_scandal_very_likely
							days = 31
						}
					}
				}
			}
		}

		#Authoritarian Conspiracy
		if = {
			limit = {

				has_authority = auth_democratic
				NOT = { has_country_flag = cc_recent_authoritarian_conspiracy }
				OR = {
					has_country_flag = cc_eventperf_has_overwhelming_rival
					has_country_flag = cc_eventperf_has_superior_rival
				}
				is_at_war = no
				has_faction = totalitarian
				any_owned_leader = {
					NOT = { is_same_value = prev.ruler }
					leader_of_faction = totalitarian
				}
			}
			set_timed_country_flag = {
				flag = cc_eventperf_can_have_authoritarian_conspiracy
				days = 31
			}
		}
		
		#Militarist Protests
		if = {
			limit = {

				NOT = { has_country_flag = dpe_recent_militarists_want_war }
				is_at_war = no
				is_subject = no
				NOT = {
					any_country = {
						OR = {
							is_country_type = extradimensional 
							is_country_type = extradimensional_2
							is_country_type = extradimensional_3
							is_country_type = ai_empire
							is_country_type = swarm
						}
					}
				}
				OR = {
					has_ethic = ethic_fanatic_militarist
					has_ethic = ethic_militarist
					AND = {
						has_faction = imperialist
						count_pop_factions = {
							limit = {
								is_pop_faction_type = imperialist
								support > 0.22
							}
							count = 1
						}
					}
				}
				years_of_peace = {
					value > 10
					delay = 20
				}
				has_federation = no
				any_relation = {

					prev = {
						OR = {
							is_rival = prev
							is_hostile_to = prev
							is_domineering_to = prev
						}
						NOT = { has_truce = prev }
					}
					any_owned_planet = {
						is_neighbor_of = prevprev
					}
					NOR = {
						relative_power = {
							who = prev
							category = fleet
							value = superior
						}
						relative_power = {
							who = prev
							category = fleet
							value = overwhelming
						}
					}
					NOT = {
						any_relation = {
							has_communications = prevprev
							OR = {
								has_defensive_pact = prev
								is_in_federation_with = prev
								is_guaranteeing = prev
							}
							relative_power = {
								who = prevprev
								category = fleet
								value = overwhelming
							}
						}
					}
					NOT = {
						count_potential_war_participants = {
							attacker = prev
							defender = this
							side = this
							limit = {
								OR = {
									relative_power = {
										who = prev
										category = fleet
										value = equivalent
									}
									relative_power = {
										who = prev
										category = fleet
										value = superior
									}
								}
							}
							count > 2
						}
					}
				}
			}
			set_timed_country_flag = {
				flag = dpe_militarist_protests_incident_possible
				days = 31
			}
			
			if = {
				limit = {
					is_ai = yes
					any_relation = {
						is_ai = no
						NOT = { has_country_flag = dpe_recent_militarists_incident }
						has_federation = no
						has_policy_flag = unrestricted_wars
						prev = {
							OR = {
								is_rival = prev
								is_hostile_to = prev
								is_domineering_to = prev
							}
							NOT = { has_truce = prev }
						}
						any_owned_planet = {
							is_neighbor_of = prevprev
						}
						NOT = {
							relative_power = {
								who = prev
								category = fleet
								value = overwhelming
							}
						}
					}
				}
				set_timed_country_flag = {
					flag = dpe_militarists_incident_secondary_possible
					days = 31
				}
			}			
		}
		#Military Coup
		if = {
			limit = {

				NOR = {
					has_ethic = ethic_gestalt_consciousness
					has_ethic = ethic_militarist
					has_ethic = ethic_fanatic_militarist
					has_ethic = ethic_fanatic_egalitarian
				}
				is_at_war = no
				is_subject = no
				has_faction = imperialist
				OR = {
					has_ethic = ethic_pacifist
					has_ethic = ethic_fanatic_pacifist
					count_pop_factions = {
						limit = {
							is_pop_faction_type = imperialist
							
							pop_percentage = {
								limit = { happiness < 0.4 }
								percentage > 0.75
							}
						}
						count = 1
					}
				}
				NOT = {
					any_country = {
						OR = {
							is_hostile_to = prev
							is_rival = prev
							is_domineering_to = prev
						}
						relative_power = {
							who = prev
							category = fleet
							value = overwhelming
						}
					}
				}
				used_naval_capacity_percent > 1
				
				any_owned_leader = {
					NOT = { is_same_value = prev.ruler }
					leader_of_faction = imperialist
				}
				exists = ruler
			}
			set_timed_country_flag = {
				flag = dpe_military_coup_possible
				days = 31
			}
		}

		#Spiritualist Mission
		if = {
			limit = {

				years_passed > 20
				
				NOT = { has_country_flag = dpe_recent_spiritualist_mission }
				
				OR = {
					has_ethic = ethic_spiritualist
					has_ethic = ethic_fanatic_spiritualist
		#			count_pop_factions = {
		#				limit = {
		#					is_pop_faction_type = traditionalist
		#					support > 0.15
		#					pop_percentage = {
		#						limit = { happiness > 0.55 }
		#						percentage > 0.75
		#					}
		#				}
		#				count = 1
		#			}
				}
				NOR = { #just in case
					has_ethic = ethic_materialist
					has_ethic = ethic_fanatic_materialist
					has_civic = civic_fanatic_purifiers
				}
				
				any_neighbor_country = {
					is_country_type = default
					has_communications = prev
					NOR = {
						is_same_species = prev
						is_at_war_with = prev

						has_civic = civic_fanatic_purifiers

						has_defensive_pact = prev
						is_in_federation_with = prev
						
						has_ethic = ethic_gestalt_consciousness
						has_ethic = ethic_spiritualist
						has_ethic = ethic_fanatic_spiritualist
						count_pop_factions = {
							limit = {
								is_pop_faction_type = traditionalist
								support > 0.2
							}
							count = 1
						}
						
						is_hostile_to = prev
						is_rival = prev
						
						has_country_flag = dpe_recent_spiritualist_mission_received
						has_relation_flag = {
							flag = dpe_spiritualist_mission_received
							who = prev
						}
					}
				}
			}
			set_timed_country_flag = {
				flag = dpe_spiritualist_mission_possible
				days = 31
			}
		}
	}
}

#yearly
event = {
	id = cc_events_performance.1999
	hide_window = yes
	is_triggered_only = yes
	
	immediate = {
		
		every_country = {
			every_owned_planet = {
				limit = { has_building = building_capital_3 }
				if = {
					limit = {
						OR = {
							AND = {
								has_building = building_physics_lab_3
								has_building = building_engineering_facility_3
								has_building = building_biolab_4
							}
							AND = {
								has_building = building_physics_lab_3
								has_building = building_engineering_facility_4
								has_building = building_biolab_3
							}
							AND = {
								has_building = building_physics_lab_4
								has_building = building_engineering_facility_3
								has_building = building_biolab_3
							}
						}
					}
					set_timed_planet_flag = {
						flag = cc_eventperf_developed_planet
						days = 365
					}
					if = {
						limit = {
							OR = {
								AND = {
									has_building = building_power_plant_4
									has_building = building_hydroponics_farm_3
									has_building = building_mining_network_3
								}
								AND = {
									has_building = building_power_plant_3
									has_building = building_hydroponics_farm_4
									has_building = building_mining_network_3
								}
								AND = {
									has_building = building_power_plant_3
									has_building = building_hydroponics_farm_3
									has_building = building_mining_network_4
								}
							}
							OR = {
								has_building = building_mineral_processing_plant_2
								has_building = building_power_hub_2
							}
						}
						set_timed_planet_flag = {
							flag = cc_eventperf_highly_developed_planet
							days = 365
						}
					}
				}
			}
			if = {
				limit = {
					any_owned_planet = { has_modifier = cc_religious_centre }
				}
				every_owned_planet = {
					limit = {
						owner = {
							any_owned_planet = {
								has_modifier = cc_religious_centre
								distance = {
									source = prevprev
									max_distance <= 75
									min_distance >= 0
								}
							}
						}
					}
					set_timed_planet_flag = {
						flag = cc_eventperf_near_religious_centre
						days = 365
					}
				}
			}
			every_owned_planet = {
				limit = {
					count_pops = {
						count > 2
						limit = {
							NOT = { is_same_species = prev }
							is_enslaved = no
							has_citizenship_rights = yes
							is_robot_pop = no
						}
					}
				}
				set_timed_planet_flag = {
					flag = cc_eventperf_planet_xenos_with_rights
					days = 365
				}
			}
			every_owned_planet = {
				limit = {
					owner = { 
						any_neighbor_country = {
							OR = {
								is_hostile_to = prev
								is_domineering_to = prev
								is_rival = prev			
							}		
							prevprev = { is_neighbor_of = prev }
						}
					}
				}
				set_timed_planet_flag = {
					flag = cc_eventperf_planet_hostile_border
					days = 365
				}
			}
		}
		
		every_playable_country = {
			country_event = { id = cc_events_performance.11112 days = 1 random = 3 }
		}
	}
}


country_event = {
	id = cc_events_performance.11112
	hide_window = yes
	is_triggered_only = yes
	
	immediate = {
		if = {
			limit = {
				OR = {
					AND = {
						pop_percentage = {
							percentage < 0.4
							limit = { is_same_species = root }
						}
						any_owned_pop = {
							NOT = { is_same_species = root }
							is_robot_pop = no
							species = { pops_have_happiness = yes }
							NOR = {
								is_enslaved = yes
								is_being_purged = yes
							}
						}
					}
				
					any_owned_pop = {
						NOR = {
							is_subspecies = prev
							is_same_species = prev
						}
						is_robot_pop = no
						species = { pops_have_happiness = yes }
						NOR = {
							is_enslaved = yes
							is_being_purged = yes
						}
						root = {
							pop_percentage = {
								percentage > 0.1
								limit = { is_same_species = prev }
							}
						}
					}
				}
			}
			set_timed_country_flag = {
				flag = cc_eventperf_has_minority
				days = 365
			}
			if = {
				limit = {
					any_owned_pop = {
						NOR = {
							is_subspecies = prev
							is_same_species = prev
						}
						is_robot_pop = no
						species = { pops_have_happiness = yes }
						NOR = {
							is_enslaved = yes
							is_being_purged = yes
						}
						prev = {
							pop_percentage = {
								percentage > 0.2
								limit = { is_same_species = prev }
							}
						}
					}
				}
				set_timed_country_flag = {
					flag = cc_eventperf_has_large_minority
					days = 365
				}
			}
		}
		if = {
			limit = {
				any_owned_pop = {
					NOR = {
						is_subspecies = prev
						is_same_species = prev
					}
					is_robot_pop = no
					species = { pops_have_happiness = yes }
					NOR = {
						is_enslaved = yes
						is_being_purged = yes
					}
					owner = {
						pop_percentage = {
							percentage > 0.05
							limit = { is_same_species = prev }
						}
					}
				}
			}
			set_timed_country_flag = {
				flag = cc_eventperf_a_small_minority
				days = 365
			}
			if = {
				limit = {
					any_owned_pop = {
						NOR = {
							is_subspecies = prev
							is_same_species = prev
						}
						is_robot_pop = no
						species = { pops_have_happiness = yes }
						NOR = {
							is_enslaved = yes
							is_being_purged = yes
						}
						owner = {
							pop_percentage = {
								percentage > 0.2
								limit = { is_same_species = prev }
							}
						}
					}
				}
				set_timed_country_flag = {
					flag = cc_eventperf_has_minority
					days = 365
				}
				if = {
					limit = {
						pop_percentage = {
							percentage < 0.4
							limit = { is_same_species = owner_species }
						}
					}
					set_timed_country_flag = {
						flag = cc_eventperf_founder_is_minority
						days = 365
					}
				}
			}
		}
		if = {
			limit = {

				NOR = {
					has_ethic = ethic_xenophobe
					has_ethic = ethic_fanatic_xenophobe
				}

				pop_percentage = {
					percentage > 0.18
					limit = { has_ethic = ethic_xenophobe }
				}
			}
			set_timed_country_flag = {
				flag = cc_eventperf_has_lots_of_xenophobes_min
				days = 365
			}
		}
		if = {
			limit = {


				pop_percentage = {
					percentage > 0.02
					limit = {
						NOR = {
							is_enslaved = yes
							is_being_purged = yes
						}
						has_pop_flag = cc_literally_xenophile_manifested
					}
				}
			}
			set_timed_country_flag = {
				flag = cc_eventperf_literally_xenophiles
				days = 365
			}
			if = {
				limit = {
					pop_percentage = {
						percentage > 0.04
						limit = {
							NOR = {
								is_enslaved = yes
								is_being_purged = yes
							}
							has_pop_flag = cc_literally_xenophile_manifested
						}
					}
				}
				set_timed_country_flag = {
					flag = cc_eventperf_lots_literally_xenophiles
					days = 365
				}
			}
		}

		if = {
			limit = {

				count_pop_factions = {
					limit = {	
						is_pop_faction_type = traditionalist
						support > 0.1
					}
					count = 1
				}
			}
			set_timed_country_flag = {
				flag = cc_enough_spiritualists
				days = 365
			}
		}
		if = {
			limit = {

				count_pop_factions = {
					limit = {	
						is_pop_faction_type = technologist
						support > 0.33
					}
					count = 1
				}
			}
			set_timed_country_flag = {
				flag = cc_many_materialists
				days = 365
			}
			if = {
				limit = {
					count_pop_factions = {
						limit = {	
							is_pop_faction_type = technologist
							support > 0.5
						}
						count = 1
					}
				}
				set_timed_country_flag = {
					flag = cc_lots_materialists
					days = 365
				}
			}
		}
		if = {
			limit = {

				count_pop_factions = {
					limit = {	
						is_pop_faction_type = progressive
						support > 0.1
					}
					count = 1
				}
			}
			set_timed_country_flag = {
				flag = cc_enough_egalitarians
				days = 365
			}
		}
		if = {
			limit = {

				count_pop_factions = {
					limit = {	
						is_pop_faction_type = totalitarian
						support > 0.4
					}
					count = 1
				}
			}
			set_timed_country_flag = {
				flag = cc_many2_authoritarians
				days = 365
			}
		}
	}
}





country_event = {
	id = cc_events_performance.2
	hide_window = yes
	
	trigger = {
		is_country_type = default
		has_faction = xenoist
		
		has_country_flag = cc_eventperf_has_minority
		
		NOR = {
			has_country_flag = recent_xenophobic_comments
			has_ethic = ethic_gestalt_consciousness
			has_ethic = ethic_fanatic_xenophile
		}
		
		
		exists = ruler
		NOT = { ruler = { leader_of_faction = xenoist } }
	}
	
	mean_time_to_happen = {
		years = 30
	}
	
	immediate = {
		random_list = {
			2 = {
				if = {
					limit = {
						OR = {
							has_authority = auth_democratic
							has_authority = auth_oligarchic
							has_authority = auth_dictatorial
						}
					}
					country_event = { id = cc_events_mod.1 }
				}
				if = {
					limit = { has_authority = auth_imperial }
					country_event = { id = cc_events_mod.2 }
				}
				modifier = {
					factor = 2
					ruler = { leader_of_faction = supremacist }
				}
				modifier = {
					factor = 2
					OR = {
						has_ethic = ethic_xenophobe
						has_ethic = ethic_fanatic_xenophobe
					}
				}
			}
			2 = {
				modifier = {
					factor = 1.5
					has_ethic = ethic_xenophile
				}
				modifier = {
					factor = 1.25
					NOT = { has_country_flag = cc_eventperf_has_large_minority }
				}
				modifier = {
					factor = 1.25
					NOT = { has_country_flag = cc_eventperf_has_lots_of_xenophobes_min }
				}
			}
		}
	}
}

#country_event = { id = cc_events_performance.3 } was no longer necessary, got subsumed into .2

country_event = {
	id = cc_events_performance.4
	hide_window = yes
	
	trigger = {
		is_country_type = default
		
		has_faction = xenoist
		
		NOT = { has_ethic = ethic_gestalt_consciousness }
		NOT = { has_country_flag = cc_has_had_interspecies_marriage }
		
		
		has_country_flag = cc_eventperf_literally_xenophiles
	}
	
	mean_time_to_happen = {
		years = 20
		
#		modifier = {
#			factor = 0.5
#			has_country_flag = cc_eventperf_lots_literally_xenophiles
#		}
	}
	immediate = { country_event = { id = cc_events_mod.7 } }
}



#converted from a 50 mtth into a monthly pulse (and back)
pop_event = {
	id = cc_events_performance.6
	hide_window = yes
	
	mean_time_to_happen = { years = 20 }

	trigger = {
		has_pop_flag = cc_literally_xenophile
		NOT = { has_pop_flag = cc_literally_xenophile_manifested }
		exists = owner
		owner = { has_country_flag = cc_eventperf_has_minority }
		species = { pops_have_happiness = yes }
	}
	
	immediate = {
		random_list = {
			100 = { pop_event = { id = cc_events_mod.10 } }
			100 = {
				modifier = {
					factor = 0.75
					owner = { has_country_flag = cc_has_had_interspecies_marriage }
				}
				modifier = {
					factor = 2
					has_ethic = ethic_xenophobe
				}
				modifier = {
					factor = 0.5
					has_ethic = ethic_xenophile
				}
				modifier = {
					factor = 0.75
					owner = { has_country_flag = cc_eventperf_founder_is_minority }
				}
			}
		}
	}
}


#converted from a 50 mtth into a monthly pulse
pop_event = {
	id = cc_events_performance.7
	hide_window = yes
	
	mean_time_to_happen = { years = 25 }

	trigger = {
		species = { pops_have_happiness = yes }
		has_pop_flag = cc_literally_xenophile_manifested
		exists = owner
		owner = { NOT = { has_country_flag = cc_eventperf_has_minority } }
	}
	
	immediate = {
		random_list = {
			1 = {
				pop_event = { id = cc_events_mod.11 }
			}			
			1 = {
				modifier = {
					factor = 2
					owner = { has_policy_flag = allows_im }
				}
				modifier = {
					factor = 0.25
					owner = { NOT = { has_country_flag = cc_eventperf_a_small_minority } }
				}
			}
		}
	}
}
	
	
	
	
	


country_event = {
	id = cc_events_performance.10
	hide_window = yes

	trigger = {
		NOT = { has_country_flag = dpe_recent_charity_scandal }
		OR = {
			AND = {
				has_ethic = ethic_fanatic_materialist
				NOT = { has_ethic = ethic_egalitarian }
			}
			has_ethic = ethic_fanatic_authoritarian
			AND = {
				has_ethic = ethic_materialist
				has_ethic = ethic_authoritarian
			}
		}
		exists = ruler
		ruler = { NOT = { leader_of_faction = totalitarian } }
		count_pop_factions = {
			limit = {
				is_pop_faction_type = progressive
				support > 0.1
				pop_percentage = {
					limit = { happiness > 0.5 }
					percentage > 0.74
				}
			}
			count = 0
		}
		any_owned_pop = {
			is_enslaved = no
			is_being_purged = no
			NOT = {
				has_ethic = ethic_gestalt_consciousness
			}
			NOR = {
				has_living_standard = {
					type = living_standard_academic_privilege
				}
				has_living_standard = {
					type = living_standard_utopian
				}
				has_living_standard = {
					type = living_standard_good
				}
			}
		}
	}

	mean_time_to_happen = {
		years = 90
		
#		modifier = {
#			factor = 0.75
#			OR = {
#				has_ethic = ethic_fanatic_authoritarian
#				has_ethic = ethic_authoritarian
#			}
#		}
#		modifier = {
#			factor = 1.5
#			NOT = { has_faction = progressive }
#		}
#		modifier = {
#			factor = 0.5
#			exists = ruler
#			ruler = { leader_of_faction = progressive }
#		}
	}
	immediate = { country_event = { id = dpe_scandal.1 } }
}


#Ruler is an ex-slave
country_event = {
	id = cc_events_performance.11
	hide_window = yes
	
	trigger = {
		years_passed > 10

		NOT = { has_ethic = ethic_gestalt_consciousness }
		allows_slavery = yes
		
		NOT = { has_country_flag = dpe_recent_escaped_slave_ruler }
		
		NOT = { has_authority = auth_imperial }
		exists = ruler
		
		any_owned_pop = {
			is_same_species = root.ruler
			is_enslaved = yes
		}
	}
			
	mean_time_to_happen = { years = 115 }
	
	immediate = {
		country_event = { id = dpe_scandal.10 }
	}
}


#Authoritarian Conspiracy
country_event = {
	id = cc_events_performance.12
	hide_window = yes
	
	trigger = {
		has_country_flag = cc_eventperf_can_have_authoritarian_conspiracy
	}
	
	mean_time_to_happen = { years = 75 }
	
	immediate = {
		if = {
			limit = { is_ai = no }
			country_event = { id = dpe_conspiracy.20 }
		}
		else = {
			random_list = {
				2 = { country_event = { id = dpe_conspiracy.20 } }
				2 = { }
			}
		}
	}
}




##Prominent Interspecies Marriage
country_event = {
	id = cc_events_performance.15
	hide_window = yes
	
	trigger = {
		has_country_flag = cc_eventperf_PIM_possible
	}
	
	mean_time_to_happen = {
		years = 35
		
#		modifier = {
#			factor = 0.8
#			OR = {
#				has_ethic = ethic_xenophile
#				has_ethic = ethic_fanatic_xenophile
#			}
#		}
	}
	immediate = { country_event = { id = cc_events_mod.16 } }
}
	

#Xeno Sex Scandal
country_event = {
	id = cc_events_performance.16
	hide_window = yes
	
	trigger = {
		has_country_flag = cc_eventperf_xeno_sex_scandal_possible
	}
	
	mean_time_to_happen = {
		years = 30
	}
	
	immediate = {
		random_list = {
			1 = {
				random_list = {
					3 = {
						country_event = { id = cc_events_mod.17 }
						modifier = {
							factor = 0
							NOT = { exists = ruler }
						}
						modifier = {
							factor = 0.75
							exists = ruler
							ruler = { leader_of_faction = supremacist }
						}
						modifier = {
							factor = 3
							exists = ruler
							ruler = { leader_of_faction = xenoist }
						}
					}
					4 = {
						country_event = { id = cc_events_mod.18 }
						modifier = {
							factor = 1.5
							any_owned_leader = {
								NOT = { is_same_value = prev.ruler }
								leader_of_faction = xenoist
							}
						}
					}
				}
			}
			1 = {
				modifier = {
					factor = 0.8
					has_country_flag = cc_eventperf_has_minority
				}
				modifier = {
					factor = 0.9
					has_policy_flag = bans_im_completely
				}
				modifier = {
					factor = 1.5
					NOT = { has_faction = xenoist }
				}
				modifier = {
					factor = 0.75
					any_owned_leader = {
						has_leader_flag = cc_xenoist_leader
					}
				}
				modifier = {
					factor = 0.5
					exists = ruler
					ruler = { has_leader_flag = cc_xenoist_leader }
				}
				modifier = {
					factor = 1.25
					has_ethic = ethic_fanatic_xenophobe
				}
			}
		}
	}
}





#Literally xenophile
pop_event = {
	id = cc_events_performance.20
	hide_window = yes
	
	trigger = {
		exists = owner
		owner = { has_policy_flag = bans_im_completely }
		is_valid_xenophilia_refugee_pop = yes
	}

	mean_time_to_happen = { years = 30 }

	immediate = {
		random_list = {
			100 = {
				pop_event = { id = cc_events_mod.13 }
			}			
			30 = {
				modifier = {
					factor = 0
					NOT = { is_same_species = owner }
				}
			}
		}
	}
}

pop_event = {
	id = cc_events_performance.21
	hide_window = yes
	mean_time_to_happen = { years = 38 }

	trigger = {
		has_modifier = cc_secret_xenophile

		exists = owner
		owner = {
			has_policy_flag = bans_im_completely
			OR = {
				has_valid_civic = civic_fanatic_purifiers
				has_policy_flag = purge_allowed
				has_edict = cc_thought_police
			}
		}
	}
	
	immediate = {
		random_list = {
			80 = { pop_event = { id = cc_events_mod.14 } }
			20 = {
				modifier = {
					factor = 0
					is_same_species = owner
				}
			}
		}
	}
}



#Militarist Protests
country_event = {
	id = cc_events_performance.25
	hide_window = yes

	trigger = {
		has_country_flag = dpe_militarist_protests_incident_possible
	}
	
	mean_time_to_happen = {
		years = 8
#		modifier = {
#			factor = 3
#			is_ai = yes
#		}
	}
	
	immediate = {
		if = {
			limit = { is_ai = no }
			country_event = { id = dpe_diplo.1 }
		}
		else = {
			random_list = {
				2 = { country_event = { id = dpe_diplo.1 } }
				3 = { }
			}
		}
	}
}

#Militarists hijack
country_event = {
	id = cc_events_performance.26
	hide_window = yes

	trigger = {
		has_country_flag = dpe_militarists_incident_secondary_possible
	}
	
	mean_time_to_happen = { #the conditions are fairly improbable, and it also has a small chance of happening via dpe_diplo.1
		years = 27
	}
	
	immediate = {
		random_relation = {
			limit = {
				is_ai = no
				NOT = { has_country_flag = dpe_recent_militarists_incident }
				prev = {
					OR = {
						is_rival = prev
						is_hostile_to = prev
						is_domineering_to = prev
					}
					NOT = { has_truce = prev }
				}
				any_owned_planet = {
					is_neighbor_of = prevprev
				}
				NOT = {
					relative_power = {
						who = prev
						category = fleet
						value = overwhelming
					}
				}
			}
			country_event = { id = dpe_diplo.5 }
		}			
	}
}

#Military Coup Chain
country_event = {
	id = cc_events_performance.27
	hide_window = yes
	
	trigger = { has_country_flag = dpe_military_coup_possible }
	
	mean_time_to_happen = { years = 75 }

	immediate = {
		if = {
			limit = { is_ai = no }
			country_event = { id = dpe_conspiracy.1 }
		}
		else = {
			random_list = {
				1 = { country_event = { id = dpe_conspiracy.1 } }
				3 = { }
			}
		}
	}
}
