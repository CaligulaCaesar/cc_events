namespace = dpe_egalitarian_missions

country_event = {
	id = dpe_egalitarian_missions.1
	title = dpe_egalitarian_missions.1.name
	desc = dpe_egalitarian_missions.1.desc

	picture = GFX_evt_arguing_senate
	is_triggered_only = yes

	# mean_time_to_happen = {
	# 	years = 50
	# }

	trigger = {
		is_country_type = default
		NOR = {
			has_country_flag = dpe_has_recent_egalitarian_mission
			has_country_flag = dpe_provided_with_egalitarian_mission
			has_ethic = ethic_gestalt_consciousness
			is_democracy = yes
			is_egalitarian = yes
			has_ethic = ethic_fanatic_authoritarian
		}
		has_faction = progressive

		any_relation = {
			is_country_type = default
			
			is_democracy = yes
			has_faction = progressive
#			OR = {
#				has_ethic = ethic_egalitarian
#				has_ethic = ethic_fanatic_egalitarian
#			}
			OR = {
				is_in_federation_with = root
				has_defensive_pact = root
				has_non_aggression_pact = root
				is_overlord_to = root
			}
			NOR = {
				has_country_flag = dpe_has_recent_egalitarian_mission
				has_country_flag = dpe_has_provided_egalitarian_mission@root
				has_relation_flag = {
					flag = dpe_asked_for_egalitarian_mission
					who = root
				}
			}
		}
	}
	immediate = {
		set_timed_country_flag = {
			flag = dpe_has_recent_egalitarian_mission
			years = 60
		}
		random_relation = {
			limit = {
				is_country_type = default
				
				is_democracy = yes
				has_faction = progressive
#				OR = {
#					has_ethic = ethic_egalitarian
#					has_ethic = ethic_fanatic_egalitarian
#				}
				OR = {
					is_in_federation_with = root
					has_defensive_pact = root
					has_non_aggression_pact = root
				}
				NOR = {
					has_country_flag = dpe_has_recent_egalitarian_mission
					has_country_flag = dpe_has_provided_egalitarian_mission@root
					has_relation_flag = {
						flag = dpe_asked_for_egalitarian_mission
						who = root
					}
				}
			}
			save_event_target_as = dpe_egalitarian
		}
	}
	option = {
		name = dpe_egalitarian_missions.1.A

		custom_tooltip = dpe_egalitarian_missions.1.A.tooltip

		random_pop_faction = {
			limit = { is_pop_faction_type = progressive }
			add_modifier = {
				modifier = dpe_electoral_experiment_faction
				years = 10
			}
		}

		random_pop_faction = {
			limit = { is_pop_faction_type = totalitarian }
			add_modifier = {
				modifier = dpe_electoral_experiment_faction_negative
				years = 10
			}
		}

		hidden_effect = {
			event_target:dpe_egalitarian = {
				set_timed_country_flag = {
					flag = dpe_has_recent_egalitarian_mission
					years = 60
				}
				set_relation_flag = {
					flag = dpe_asked_for_egalitarian_mission
					who = root
				}
				country_event = { id = dpe_egalitarian_missions.2 }
			}
		}

		event_target:dpe_egalitarian = {
			DPE_Get_Attitude = yes
		}
		ai_chance = {
			factor = 1
			modifier = {
				factor = 0
				count_pop_faction = {
					limit = {
						is_pop_faction_type = progressive
						support > 0.05
					}
					count = 0
				}
			}
			modifier = {
				factor = 2
				any_pop_faction = {
					is_pop_faction_type = progressive
					support > 0.15
				}
			}
		}
	}
	option = {
		name = dpe_egalitarian_missions.1.B

		random_pop_faction = {
			limit = { is_pop_faction_type = progressive }
			add_modifier = {
				modifier = dpe_denied_elections
				years = 10
			}
		}

		custom_tooltip = dpe_egalitarian_missions.1.B.tooltip #Every other pop faction but the totalitarian faction receive the modifier §R$dpe_denied_a_say$§!, giving:\n\n§R-20% $MOD_FACTION_APPROVAL$§!
		hidden_effect = {
			every_pop_faction = {
				limit = {
					NOR = {
						is_pop_faction_type = totalitarian
						is_pop_faction_type = progressive
					}
				}
				add_modifier = {
					modifier = dpe_denied_a_say
					years = 10
				}
			}
		}
		ai_chance = {
			factor = 1
			modifier = {
				factor = 2
				count_pop_faction = {
					limit = {
						is_pop_faction_type = progressive
						support > 0.1
					}
					count = 0
				}
			}
			modifier = {
				factor = 2
				count_pop_faction = {
					limit = {
						is_pop_faction_type = progressive
						support > 0.05
					}
					count = 0
				}
			}
			modifier = {
				factor = 0.5
				any_pop_faction = {
					is_pop_faction_type = progressive
					support > 0.15
				}
			}
		}
	}
}


country_event = {
	id = dpe_egalitarian_missions.2
	title = dpe_egalitarian_missions.2.name
	desc = dpe_egalitarian_missions.2.desc

	diplomatic = yes

	picture_event_data = {
		portrait = from
		planet_background = from
		graphical_culture = from
		city_level = from
		room = from.ruler
	}

	is_triggered_only = yes

	option = {
		name = dpe_egalitarian_missions.2.option

		hidden_effect = { country_event = { id = dpe_egalitarian_missions.3 } }
	}
}


country_event = {
	id = dpe_egalitarian_missions.3
	title = dpe_egalitarian_missions.3.name
	desc = dpe_egalitarian_missions.3.desc

	diplomatic = yes

	picture_event_data = {
		portrait = fromfrom
		planet_background = fromfrom
		graphical_culture = fromfrom
		city_level = fromfrom
		room = fromfrom.ruler
	}

	is_triggered_only = yes

	option = {
		name = dpe_egalitarian_missions.3.option

		hidden_effect = { country_event = { id = dpe_egalitarian_missions.4 } }
	}
}

country_event = {
	id = dpe_egalitarian_missions.4
	title = dpe_egalitarian_missions.4.name
	desc = dpe_egalitarian_missions.4.desc

	diplomatic = yes

	picture_event_data = {
		portrait = fromfromfrom
		planet_background = fromfromfrom
		graphical_culture = fromfromfrom
		city_level = fromfromfrom
		room = fromfromfrom.ruler
	}

	is_triggered_only = yes

	option = {
		name = dpe_egalitarian_missions.4.A
		custom_tooltip = dpe_egalitarian_missions.4.help.tooltip

		fromfromfrom = {
			add_opinion_modifier = {
				modifier = dpe_helping_with_elections
				who = root
			}
			hidden_effect = {
				set_country_flag = dpe_provided_with_egalitarian_mission
				country_event = { id = dpe_egalitarian_missions.6 days = 5 }
			}
		}
		hidden_effect = {
			set_country_flag = dpe_has_provided_egalitarian_mission@fromfromfrom
		}
		
		ai_chance = {
			factor = 1
			modifier = {
				factor = 0.5
				OR = {
					has_non_aggression_pact = fromfromfrom
					is_overlord_to = fromfromfrom
				}
			}
			modifier = {
				factor = 1.5
				is_friendly_to = fromfromfrom
			}
			modifier = {
				factor = 2
				fromfromfrom = {
					relative_power = {
						who = root
						value > equivalent
					}
				}
			}
		}
	}

	option = {
		name = dpe_egalitarian_missions.4.B

		fromfromfrom = {
			add_opinion_modifier = {
				modifier = dpe_rejected_help_with_elections
				who = root
			}
			hidden_effect = { country_event = { id = dpe_egalitarian_missions.5 days = 5 } }
		}
		
		ai_chance = {
			factor = 1
			modifier = {
				factor = 2
				has_ethic = ethic_fanatic_egalitarian
			}
			modifier = {
				factor = 0.5
				fromfromfrom = {
					relative_power = {
						who = root
						value > equivalent
					}
				}
			}
		}
	}
	
	option = {
		name = dpe_egalitarian_missions.4.C
		custom_tooltip = dpe_egalitarian_missions.4.help.tooltip

		fromfromfrom = {
			add_opinion_modifier = {
				modifier = dpe_offered_some_help_with_elections
				who = root
			}
			hidden_effect = { country_event = { id = dpe_egalitarian_missions.7 days = 5 } }
		}
		
		ai_chance = {
			factor = 1
			modifier = {
				factor = 2
				OR = {
					has_non_aggression_pact = fromfromfrom
					is_overlord_to = fromfromfrom
				}
			}
			modifier = {
				factor = 2
				fromfromfrom = {
					relative_power = {
						who = root
						value < equivalent
					}
				}
			}
			modifier = {
				factor = 2
				has_monthly_income = {
					resource = minerals
					value < 50
				}
				resource_stockpile_compare = {
					resource = minerals
					value < 2500
				}
			}
		}
	}
}

#negative response
country_event = {
	id = dpe_egalitarian_missions.5
	title = dpe_egalitarian_missions.5.name
	desc = dpe_egalitarian_missions.6.desc

	diplomatic = yes

	picture_event_data = {
		portrait = from
		planet_background = from
		graphical_culture = from
		city_level = from
		room = from.ruler
	}

	is_triggered_only = yes

	option = { name = UNFORTUNATE }
}


#positive response
country_event = {
	id = dpe_egalitarian_missions.6
	title = dpe_egalitarian_missions.6.name
	desc = dpe_egalitarian_missions.5.desc

	diplomatic = yes

	picture_event_data = {
		portrait = from
		planet_background = from
		graphical_culture = from
		city_level = from
		room = from.ruler
	}

	is_triggered_only = yes

	option = {
		name = EXCELLENT

		add_modifier = {
			modifier = dpe_electoral_experiment
			years = 10
		}

		hidden_effect = { from = { country_event = { id = dpe_egalitarian_missions.8 days = 90 } } }
	}
}

#bribe response
country_event = {
	id = dpe_egalitarian_missions.7
	title = dpe_egalitarian_missions.7.name
	desc = dpe_egalitarian_missions.7.desc

	diplomatic = yes

	picture_event_data = {
		portrait = from
		planet_background = from
		graphical_culture = from
		city_level = from
		room = from.ruler
	}

	is_triggered_only = yes

	option = {
		name = dpe_egalitarian_missions.7.A

		add_modifier = {
			modifier = dpe_paying_foreign_country
			months = 8
		}

		add_modifier = {
			modifier = dpe_electoral_experiment
			years = 1
		}

		hidden_effect = {
			set_country_flag = dpe_provided_with_egalitarian_mission
			from = {
				hidden_effect = {
					country_event = { id = dpe_egalitarian_missions.72 }
					country_event = { id = dpe_egalitarian_missions.8 days = 90 }
				}
			}
		}

		ai_chance = {
			factor = 1
			modifier = {
				factor = 0.5
				any_country = {
					OR = {
						is_hostile_to = root
						is_rival = root
						is_domineering_to = root
					}
					relative_power = {
						who = root
						value = overwhelming
					}
				}
			}
			modifier = {
				factor = 0.5
				has_monthly_income = {
					resource = minerals
					value < 50
				}
				resource_stockpile_compare = {
					resource = minerals
					value < 2500
				}
			}
			modifier = {
				factor = 2
				has_monthly_income = {
					resource = minerals
					value > 150
				}
			}
		}
	}
	
	option = {
		name = dpe_egalitarian_missions.7.B

		hidden_effect = { from = { country_event = { id = dpe_egalitarian_missions.71 } } }

		ai_chance = {
			factor = 1
		}
	}
}

#negative response
country_event = {
	id = dpe_egalitarian_missions.71
	title = dpe_egalitarian_missions.71.name
	desc = dpe_egalitarian_missions.71.desc

	diplomatic = yes

	picture_event_data = {
		portrait = from
		planet_background = from
		graphical_culture = from
		city_level = from
		room = from.ruler
	}

	is_triggered_only = yes

	option = {
		name = UNFORTUNATE

		from = {
			add_opinion_modifier = {
				who = root
				modifier = dpe_rejected_help_with_elections
			}
			hidden_effect = {
				remove_opinion_modifier = {
					who = root
					modifier = dpe_offered_some_help_with_elections
				}
			}
		}
	}
}


#positive response
country_event = {
	id = dpe_egalitarian_missions.72
	title = dpe_egalitarian_missions.72.name
	desc = dpe_egalitarian_missions.72.desc

	diplomatic = yes

	picture_event_data = {
		portrait = from
		planet_background = from
		graphical_culture = from
		city_level = from
		room = from.ruler
	}

	is_triggered_only = yes

	option = {
		name = EXCELLENT

		add_resource = {
			minerals = 1000
		}
		
		hidden_effect = {
			set_country_flag = dpe_has_provided_egalitarian_mission@from
		}
	}
}

#cheat them or not
country_event = {
	id = dpe_egalitarian_missions.8
	title = dpe_egalitarian_missions.8.name
	desc = dpe_egalitarian_missions.8.desc
	picture = GFX_evt_galactic_senate

	is_triggered_only = yes

	trigger = {
		exists = from
	}

	option = {
		name = dpe_egalitarian_missions.8.A
		custom_tooltip = dpe_egalitarian_missions.8.A.tooltip

		hidden_effect = {
			from = {
				random_list = {
					2 = { #truly authoritarian result
						country_event = { id = dpe_egalitarian_missions.9 days = 30 }
						
						modifier = {
							factor = 2
							any_pop_faction = {
								is_pop_faction_type = totalitarian
								support > 0.6
							}
						}
						modifier = {
							factor = 2
							any_pop_faction = {
								is_pop_faction_type = totalitarian
								support > 0.4
							}
						}
						modifier = {
							factor = 0.5
							any_pop_faction = {
								is_pop_faction_type = totalitarian
								support < 0.25
							}
						}
					}
					2 = { #authoritarian result contested
						country_event = { id = dpe_egalitarian_missions.10 days = 30 }
					}
				}
			}
		}

		ai_chance = {
			factor = 2
			modifier = {
				factor = 0.5
				any_pop_faction = {
					is_pop_faction_type = progressive
					faction_approval < @cc_faction_danger_number
				}
			}
			modifier = {
				factor = 0.5
				any_pop_faction = {
					is_pop_faction_type = progressive
					support > 0.5
				}
			}
			modifier = {
				factor = 0.8
				has_ethic = ethic_egalitarian
			}
			modifier = {
				factor = 0.5
				has_ethic = ethic_fanatic_egalitarian
			}
			modifier = {
				factor = 2
				from = {
					relative_power = {
						who = root
						value > equivalent
					}
				}
			}
			modifier = {
				factor = 0.5
				from = {
					relative_power = {
						who = root
						value < equivalent
					}
				}
			}
			modifier = {
				factor = 2
				from = {
					has_defensive_pact = root
				}
			}
		}
	}
	option = {
		name = dpe_egalitarian_missions.8.B
		custom_tooltip = dpe_egalitarian_missions.8.B.tooltip

		hidden_effect = {
			from = {
				random_list = {
					1 = { #truly authoritarian result
						country_event = { id = dpe_egalitarian_missions.11 days = 30 }

						modifier = {
							factor = 2
							any_pop_faction = {
								is_pop_faction_type = totalitarian
								support > 0.6
							}
						}
						modifier = {
							factor = 2
							any_pop_faction = {
								is_pop_faction_type = totalitarian
								support > 0.4
							}
						}
						modifier = {
							factor = 0.5
							any_pop_faction = {
								is_pop_faction_type = totalitarian
								support < 0.25
							}
						}
					}
					1 = { #result contra auth wishes
						country_event = { id = dpe_egalitarian_missions.12 days = 30 }
					}
				}
			}
		}

		ai_chance = {
			factor = 1
		}
	}
}


#They complied, good result
country_event = {
	id = dpe_egalitarian_missions.9
	title = dpe_egalitarian_missions.9.name
	desc = dpe_egalitarian_missions.9.desc
	picture = GFX_evt_arguing_senate
	
	is_triggered_only = yes

	trigger = {
		exists = from
	}

	option = {
		name = dpe_egalitarian_missions.9.option

		add_modifier = {
			modifier = dpe_auth_held_successful_election
			years = 5
		}
		hidden_effect = {
			from = {
				country_event = { id = dpe_egalitarian_missions.91 }
			}
		}
	}
}

country_event = {
	id = dpe_egalitarian_missions.91
	title = dpe_egalitarian_missions.91.name
	desc = dpe_egalitarian_missions.91.desc
	picture = GFX_evt_arguing_senate
	
	is_triggered_only = yes

	option = {
		name = dpe_egalitarian_missions.91.option

		from = {
			add_opinion_modifier = {
				modifier = dpe_electoral_help_auth
				who = root
			}
			hidden_effect = {
				if = {
					limit = {
						has_opinion_modifier = {
							modifier = dpe_rejected_help_with_elections
							who = root
						}
					}
					remove_opinion_modifier = {
						modifier = dpe_rejected_help_with_elections
						who = root
					}
				}
				if = {
					limit = {
						has_opinion_modifier = {
							modifier = dpe_helping_with_elections
							who = root
						}
					}
					remove_opinion_modifier = {
						modifier = dpe_helping_with_elections
						who = root
					}
				}
				set_timed_country_flag = {
					flag = dpe_auth_elections_positive_outcome
					months = 150
				}
				country_event = { id = dpe_egalitarian_missions.20 days = 3600 }
			}
		}
	}
}


#They complied, there is some dissent
country_event = {
	id = dpe_egalitarian_missions.10
	title = dpe_egalitarian_missions.10.name
	desc = dpe_egalitarian_missions.10.desc
	picture = GFX_evt_arguing_senate
	
	is_triggered_only = yes

	trigger = {
		exists = from
	}

	option = {
		name = dpe_egalitarian_missions.10.option

		add_modifier = {
			modifier = dpe_auth_held_election
			years = 5
		}
		random_pop_faction = {
			limit = {
				is_pop_faction_type = progressive
			}
			add_modifier = {
				modifier = dpe_sham_elections
				years = 5
			}
		}
		hidden_effect = {
			from = {
				country_event = { id = dpe_egalitarian_missions.101 }
			}
		}
	}
}

country_event = {
	id = dpe_egalitarian_missions.101
	title = dpe_egalitarian_missions.101.name
	desc = dpe_egalitarian_missions.101.desc
	picture = GFX_evt_arguing_senate
	
	is_triggered_only = yes

	option = {
		name = dpe_egalitarian_missions.101.option

		random_pop_faction = {
			limit = {
				is_pop_faction_type = progressive
			}
			add_modifier = {
				modifier = dpe_betrayed_democracy_faction
				years = 10
			}
		}
		from = {
			add_opinion_modifier = {
				modifier = dpe_electoral_help_auth
				who = root
			}
			hidden_effect = {
				if = {
					limit = {
						has_opinion_modifier = {
							modifier = dpe_rejected_help_with_elections
							who = root
						}
					}
					remove_opinion_modifier = {
						modifier = dpe_rejected_help_with_elections
						who = root
					}
				}
				if = {
					limit = {
						has_opinion_modifier = {
							modifier = dpe_helping_with_elections
							who = root
						}
					}
					remove_opinion_modifier = {
						modifier = dpe_helping_with_elections
						who = root
					}
				}
				set_timed_country_flag = {
					flag = dpe_auth_elections_positive_outcome_risk
					months = 150
				}
				country_event = { id = dpe_egalitarian_missions.20 days = 3600 }
			}
		}
		every_relation = {
			limit = {
				is_democracy = yes
				is_egalitarian = yes
			}
			add_opinion_modifier = {
				who = root
				modifier = dpe_betrayed_democracy_opinion
			}
		}
	}
}


#Didn't comply, authoritarian result anyway
country_event = {
	id = dpe_egalitarian_missions.11
	title = dpe_egalitarian_missions.11.name
	desc = dpe_egalitarian_missions.11.desc
	picture = GFX_evt_arguing_senate
	
	is_triggered_only = yes

	trigger = {
		exists = from
	}

	option = {
		name = dpe_egalitarian_missions.11.option

		add_modifier = {
			modifier = dpe_auth_held_successful_election
			years = 5
		}
		hidden_effect = {
			from = {
				country_event = { id = dpe_egalitarian_missions.111 }
			}
		}
	}
}

country_event = {
	id = dpe_egalitarian_missions.111
	title = dpe_egalitarian_missions.111.name
	desc = dpe_egalitarian_missions.111.desc
	
	diplomatic = yes

	picture_event_data = {
		portrait = from
		planet_background = from
		graphical_culture = from
		city_level = from
		room = from.ruler
	}
	
	is_triggered_only = yes

	option = {
		name = dpe_egalitarian_missions.111.option

		from = {
			add_opinion_modifier = {
				modifier = dpe_electoral_help_auth_1
				who = root
			}
			hidden_effect = {
				if = {
					limit = {
						has_opinion_modifier = {
							modifier = dpe_rejected_help_with_elections
							who = root
						}
					}
					remove_opinion_modifier = {
						modifier = dpe_rejected_help_with_elections
						who = root
					}
				}
				if = {
					limit = {
						has_opinion_modifier = {
							modifier = dpe_helping_with_elections
							who = root
						}
					}
					remove_opinion_modifier = {
						modifier = dpe_helping_with_elections
						who = root
					}
				}
				set_timed_country_flag = {
					flag = dpe_auth_elections_positive_outcome_cheat
					months = 150
				}
				country_event = { id = dpe_egalitarian_missions.20 days = 3600 }
			}
		}
	}
}


#They didn't comply, the result is egalitarian
country_event = {
	id = dpe_egalitarian_missions.12
	title = dpe_egalitarian_missions.12.name
	desc = dpe_egalitarian_missions.12.desc
	picture = GFX_evt_arguing_senate
	
	is_triggered_only = yes

	trigger = {
		exists = from
	}

	option = {
		name = dpe_egalitarian_missions.12.option

		add_modifier = {
			modifier = dpe_auth_held_election
			years = 5
		}
		hidden_effect = {
			from = {
				country_event = { id = dpe_egalitarian_missions.121 }
			}
		}
	}
}

country_event = {
	id = dpe_egalitarian_missions.121
	title = dpe_egalitarian_missions.121.name
	desc = dpe_egalitarian_missions.121.desc
	
	diplomatic = yes

	picture_event_data = {
		portrait = from
		planet_background = from
		graphical_culture = from
		city_level = from
		room = from.ruler
	}
	
	is_triggered_only = yes

	option = {
		name = dpe_egalitarian_missions.121.option

		random_pop_faction = {
			limit = {
				is_pop_faction_type = progressive
			}
			add_modifier = {
				modifier = dpe_promoted_democracy_faction
				years = 10
			}
		}
		from = {
			add_opinion_modifier = {
				modifier = dpe_electoral_betrayal
				who = root
			}
			hidden_effect = {
				if = {
					limit = {
						has_opinion_modifier = {
							modifier = dpe_rejected_help_with_elections
							who = root
						}
					}
					remove_opinion_modifier = {
						modifier = dpe_rejected_help_with_elections
						who = root
					}
				}
				if = {
					limit = {
						has_opinion_modifier = {
							modifier = dpe_helping_with_elections
							who = root
						}
					}
					remove_opinion_modifier = {
						modifier = dpe_helping_with_elections
						who = root
					}
				}
				set_timed_country_flag = {
					flag = dpe_auth_elections_negative_outcome
					months = 150
				}
				country_event = { id = dpe_egalitarian_missions.20 days = 3600 }
			}
		}
		every_relation = {
			limit = {
				is_democracy = yes
				is_egalitarian = yes
			}
			add_opinion_modifier = {
				who = root
				modifier = dpe_promoted_democracy_opinion
			}
		}
	}
}


#Follow-up

country_event = {
	id = dpe_egalitarian_missions.20
	title = dpe_egalitarian_missions.20.name

	is_triggered_only = yes
	picture = GFX_evt_arguing_senate

	desc = {
		trigger = {
			OR = {
				has_country_flag = dpe_auth_elections_positive_outcome
				has_country_flag = dpe_auth_elections_positive_outcome_risk
			}
		}
		text = dpe_egalitarian_missions.20.pos
	}
	desc = {
		trigger = {
			has_country_flag = dpe_auth_elections_positive_outcome_cheat
		}
		text = dpe_egalitarian_missions.20.half_pos
	}
	desc = {
		trigger = {
			has_country_flag = dpe_auth_elections_negative_outcome
		}
		text = dpe_egalitarian_missions.20.neg
	}

	desc = {
		trigger = {
			NOT = {
				exists = from
			}
		}
		text = dpe_egalitarian_missions.20.no_more_destroyed
	}
	
	desc = {
		trigger = {
			from = { is_democracy = no }
		}
		text = dpe_egalitarian_missions.20.no_more_nodemo
	}
	
	desc = {
		trigger = {
			from = {
				NOR = {
					is_in_federation_with = root
					has_defensive_pact = root
					has_non_aggression_pact = root
					is_overlord_to = root
					root = {
						is_overlord_to = prev
					}
				}
			}
		}
		text = dpe_egalitarian_missions.20.no_friends
	}
	
	trigger = {
		NOR = {
			is_democracy = yes
			is_egalitarian = yes
			has_ethic = ethic_fanatic_authoritarian
		}
	}

	#Forced to stop
	option = {
		name = UNFORTUNATE
		trigger = {
			OR = {
				NOT = { exists = from }
				from = {
					is_democracy = no
					NOR = {
						is_in_federation_with = root
						has_defensive_pact = root
						has_non_aggression_pact = root
						is_overlord_to = root
						root = {
							is_overlord_to = prev
						}
					}
				}
			}
		}
	}

	#Positive, carry on
	option = {
		name = dpe_egalitarian_missions.20.A
		trigger = {
			OR = {
				has_country_flag = dpe_auth_elections_positive_outcome
				has_country_flag = dpe_auth_elections_positive_outcome_risk
			}
		}

		from = {
			country_event = { id = dpe_egalitarian_missions.201 }
		}
		
		ai_chance = {
			factor = 3
			modifier = {
				factor = 0
				count_pop_faction = {
					limit = {
						is_pop_faction_type = progressive
						support > 0.05
					}
					count = 0
				}
			}
			modifier = {
				factor = 2
				any_pop_faction = {
					is_pop_faction_type = progressive
					support > 0.15
				}
			}
		}
	}
	#Positive, don't carry on
	option = {
		name = dpe_egalitarian_missions.20.B
		trigger = {
			OR = {
				has_country_flag = dpe_auth_elections_positive_outcome
				has_country_flag = dpe_auth_elections_positive_outcome_risk
			}
		}

		random_pop_faction = {
			limit = {
				is_pop_faction_type = progressive
			}
			add_modifier = {
				modifier = dpe_elections_cancelled_1
				years = 10
			}
		}
		every_pop_faction = {
			limit = {
				NOR = {
					is_pop_faction_type = totalitarian
					is_pop_faction_type = progressive
				}
				OR = {
					AND = {
						root = {
							is_pacifist = no
						}
						is_pop_faction_type = prosperity
					}
					AND = {
						root = {
							is_militarist = no
						}
						is_pop_faction_type = imperialist
					}
					AND = {
						root = {
							is_materialist = no
						}
						is_pop_faction_type = technologist
					}
					AND = {
						root = {
							is_spiritualist = no
						}
						is_pop_faction_type = traditionalist
					}
					AND = {
						root = {
							is_xenophile = no
						}
						is_pop_faction_type = xenoist
					}
					AND = {
						root = {
							is_xenophobe = no
						}
						OR = {
							is_pop_faction_type = supremacist
							is_pop_faction_type = isolationist
						}
					}
				}
			}
			add_modifier = {
				modifier = dpe_elections_cancelled
				years = 5
			}
		}
		ai_chance = {
			factor = 1
			modifier = {
				factor = 5
				count_pop_faction = {
					limit = {
						is_pop_faction_type = progressive
						support > 0.05
					}
					count = 0
				}
			}
			modifier = {
				factor = 0.5
				any_pop_faction = {
					is_pop_faction_type = progressive
					support > 0.15
				}
			}
		}
	}
	
	#Positivish, carry on
	option = {
		name = dpe_egalitarian_missions.20.C
		trigger = {
			has_country_flag = dpe_auth_elections_positive_outcome_cheat
		}

		from = {
			country_event = { id = dpe_egalitarian_missions.201 }
		}
		ai_chance = {
			factor = 3
			modifier = {
				factor = 0
				count_pop_faction = {
					limit = {
						is_pop_faction_type = progressive
						support > 0.05
					}
					count = 0
				}
			}
			modifier = {
				factor = 2
				any_pop_faction = {
					is_pop_faction_type = progressive
					support > 0.15
				}
			}
		}
	}
	#Positivish, don't carry on
	option = {
		name = dpe_egalitarian_missions.20.D
		trigger = {
			has_country_flag = dpe_auth_elections_positive_outcome_cheat
		}

		random_pop_faction = {
			limit = {
				is_pop_faction_type = progressive
			}
			add_modifier = {
				modifier = dpe_elections_cancelled_1
				years = 10
			}
		}
		every_pop_faction = {
			limit = {
				NOR = {
					is_pop_faction_type = totalitarian
					is_pop_faction_type = progressive
				}
				OR = {
					AND = {
						root = {
							is_pacifist = no
						}
						is_pop_faction_type = prosperity
					}
					AND = {
						root = {
							is_militarist = no
						}
						is_pop_faction_type = imperialist
					}
					AND = {
						root = {
							is_materialist = no
						}
						is_pop_faction_type = technologist
					}
					AND = {
						root = {
							is_spiritualist = no
						}
						is_pop_faction_type = traditionalist
					}
					AND = {
						root = {
							is_xenophile = no
						}
						is_pop_faction_type = xenoist
					}
					AND = {
						root = {
							is_xenophobe = no
						}
						OR = {
							is_pop_faction_type = supremacist
							is_pop_faction_type = isolationist
						}
					}
				}
			}
			add_modifier = {
				modifier = dpe_elections_cancelled
				years = 5
			}
		}
		ai_chance = {
			factor = 2
			modifier = {
				factor = 2
				count_pop_faction = {
					limit = {
						is_pop_faction_type = progressive
						support > 0.05
					}
					count = 0
				}
			}
			modifier = {
				factor = 0.5
				any_pop_faction = {
					is_pop_faction_type = progressive
					support > 0.15
				}
			}
		}
	}
	
	#Negative, carry on
	option = {
		name = dpe_egalitarian_missions.20.E
		trigger = {
			has_country_flag = dpe_auth_elections_negative_outcome
		}

		from = {
			country_event = { id = dpe_egalitarian_missions.201 }
		}
		ai_chance = {
			factor = 0.5
		}
	}
	#Negative, don't carry on
	option = {
		name = dpe_egalitarian_missions.20.F
		trigger = {
			has_country_flag = dpe_auth_elections_negative_outcome
		}

		random_pop_faction = {
			limit = {
				is_pop_faction_type = progressive
			}
			add_modifier = {
				modifier = dpe_elections_cancelled_1
				years = 10
			}
		}
		every_pop_faction = {
			limit = {
				NOR = {
					is_pop_faction_type = totalitarian
					is_pop_faction_type = progressive
				}
				OR = {
					AND = {
						root = {
							is_pacifist = no
						}
						is_pop_faction_type = prosperity
					}
					AND = {
						root = {
							is_militarist = no
						}
						is_pop_faction_type = imperialist
					}
					AND = {
						root = {
							is_materialist = no
						}
						is_pop_faction_type = technologist
					}
					AND = {
						root = {
							is_spiritualist = no
						}
						is_pop_faction_type = traditionalist
					}
					AND = {
						root = {
							is_xenophile = no
						}
						is_pop_faction_type = xenoist
					}
					AND = {
						root = {
							is_xenophobe = no
						}
						OR = {
							is_pop_faction_type = supremacist
							is_pop_faction_type = isolationist
						}
					}
				}
			}
			add_modifier = {
				modifier = dpe_elections_cancelled
				years = 5
			}
		}
		ai_chance = {
			factor = 3
			modifier = {
				factor = 2
				count_pop_faction = {
					limit = {
						is_pop_faction_type = progressive
						support > 0.05
					}
					count = 0
				}
			}
			modifier = {
				factor = 0.5
				any_pop_faction = {
					is_pop_faction_type = progressive
					support > 0.15
				}
			}
		}
	}
}


country_event = {
	id = dpe_egalitarian_missions.201
	title = dpe_egalitarian_missions.201.name

	desc = {
		trigger = {
			from = {
				OR = {
					has_country_flag = dpe_auth_elections_positive_outcome
					has_country_flag = dpe_auth_elections_positive_outcome_risk
				}
			}
		}
		text = dpe_egalitarian_missions.201.pos
	}
	desc = {
		trigger = {
			from = {
				has_country_flag = dpe_auth_elections_positive_outcome_cheat
			}
		}
		text = dpe_egalitarian_missions.201.half_pos
	}
	desc = {
		trigger = {
			from = {
				has_country_flag = dpe_auth_elections_negative_outcome
			}
		}
		text = dpe_egalitarian_missions.201.neg
	}
	
	diplomatic = yes

	picture_event_data = {
		portrait = from
		planet_background = from
		graphical_culture = from
		city_level = from
		room = from.ruler
	}
	
	is_triggered_only = yes

	option = {
		name = dpe_egalitarian_missions.201.continue

		from = {
			hidden_effect = {
				country_event = { id = dpe_egalitarian_missions.202 days = 5 }
			}
		}
		ai_chance = {
			factor = 3
			modifier = {
				factor = 3
				from = {
					has_country_flag = dpe_auth_elections_positive_outcome
				}
			}
			modifier = {
				factor = 0
				from = {
					has_country_flag = dpe_auth_elections_positive_outcome_risk
				}
			}
			modifier = {
				factor = 2
				from = {
					relative_power = {
						who = root
						value > equivalent
					}
				}
			}
		}
	}
	
	option = {
		name = dpe_egalitarian_missions.201.bribe

		from = {
			hidden_effect = {
				country_event = { id = dpe_egalitarian_missions.2021 days = 5 }
			}
		}
		ai_chance = {
			factor = 1
			
			modifier = {
				factor = 2
				from = {
					relative_power = {
						who = root
						value < equivalent
					}
				}
			}
			modifier = {
				factor = 2
				has_monthly_income = {
					resource = minerals
					value < 50
				}
				resource_stockpile_compare = {
					resource = minerals
					value < 2500
				}
			}
			modifier = {
				factor = 1
				from = {
					has_country_flag = dpe_auth_elections_positive_outcome
				}
			}
			modifier = {
				factor = 0
				from = {
					has_country_flag = dpe_auth_elections_positive_outcome_risk
				}
			}
		}
	}

	option = {
		name = dpe_egalitarian_missions.201.cancel

		from = {
			add_opinion_modifier = {
				who = root
				modifier = dpe_cancelled_electoral_aid
			}
			if = {
				limit = {
					has_opinion_modifier = {
						who = root
						modifier = dpe_electoral_help_auth
					}
				}
				remove_opinion_modifier = {
					who = root
					modifier = dpe_electoral_help_auth
				}
			}
			if = {
				limit = {
					has_opinion_modifier = {
						who = root
						modifier = dpe_electoral_help_auth_1
					}
				}
				remove_opinion_modifier = {
					who = root
					modifier = dpe_electoral_help_auth_1
				}
			}
			hidden_effect = {
				country_event = { id = dpe_egalitarian_missions.203 days = 5 }
			}
		}
		ai_chance = {
			factor = 2
			modifier = {
				factor = 0.5
				from = {
					relative_power = {
						who = root
						value > equivalent
					}
				}
			}
		}
	}
}


country_event = {
	id = dpe_egalitarian_missions.202
	title = dpe_egalitarian_missions.202.name
	desc = dpe_egalitarian_missions.202.desc

	diplomatic = yes

	picture_event_data = {
		portrait = from
		planet_background = from
		graphical_culture = from
		city_level = from
		room = from.ruler
	}

	is_triggered_only = yes

	option = {
		name = EXCELLENT

		add_modifier = {
			modifier = dpe_upcoming_elections
			months = 3
		}
		hidden_effect = {
			from = {
				country_event = { id = dpe_egalitarian_missions.204 days = 60 }
			}
		}
	}
}


#bribe response
country_event = {
	id = dpe_egalitarian_missions.2021
	title = dpe_egalitarian_missions.2021.name
	desc = dpe_egalitarian_missions.2021.desc

	diplomatic = yes

	picture_event_data = {
		portrait = from
		planet_background = from
		graphical_culture = from
		city_level = from
		room = from.ruler
	}

	is_triggered_only = yes

	option = {
		name = dpe_egalitarian_missions.7.A

		add_modifier = {
			modifier = dpe_paying_foreign_country
			months = 8
		}

		add_modifier = {
			modifier = dpe_upcoming_elections
			months = 3
		}

		hidden_effect = {
			from = {
				country_event = { id = dpe_egalitarian_missions.2023 }
				country_event = { id = dpe_egalitarian_missions.204 days = 60 }
			}
		}

		ai_chance = {
			factor = 1
			modifier = {
				factor = 0.5
				any_country = {
					OR = {
						is_hostile_to = root
						is_rival = root
						is_domineering_to = root
					}
					relative_power = {
						who = root
						value = overwhelming
					}
				}
			}
			modifier = {
				factor = 0.5
				has_monthly_income = {
					resource = minerals
					value < 50
				}
				resource_stockpile_compare = {
					resource = minerals
					value < 2500
				}
			}
			modifier = {
				factor = 2
				has_monthly_income = {
					resource = minerals
					value > 150
				}
			}
		}
	}
	
	option = {
		name = dpe_egalitarian_missions.7.B

		hidden_effect = { from = { country_event = { id = dpe_egalitarian_missions.2022 } } }

		ai_chance = {
			factor = 1
		}
	}
}

#No bribes
country_event = {
	id = dpe_egalitarian_missions.2022
	title = dpe_egalitarian_missions.71.name
	desc = dpe_egalitarian_missions.71.desc

	diplomatic = yes

	picture_event_data = {
		portrait = from
		planet_background = from
		graphical_culture = from
		city_level = from
		room = from.ruler
	}
	
	is_triggered_only = yes

	option = {
		name = UNFORTUNATE
	}
}

#positive response
country_event = {
	id = dpe_egalitarian_missions.2023
	title = dpe_egalitarian_missions.72.name
	desc = dpe_egalitarian_missions.72.desc

	diplomatic = yes

	picture_event_data = {
		portrait = from
		planet_background = from
		graphical_culture = from
		city_level = from
		room = from.ruler
	}

	is_triggered_only = yes

	option = {
		name = EXCELLENT

		add_resource = {
			minerals = 1000
		}
	}
}

#Not continuing
country_event = {
	id = dpe_egalitarian_missions.203
	title = dpe_egalitarian_missions.203.name
	desc = dpe_egalitarian_missions.203.desc

	diplomatic = yes

	picture_event_data = {
		portrait = from
		planet_background = from
		graphical_culture = from
		city_level = from
		room = from.ruler
	}
	
	is_triggered_only = yes

	option = {
		name = UNFORTUNATE
	}
}


#cheat them or not
country_event = {
	id = dpe_egalitarian_missions.204
	title = dpe_egalitarian_missions.204.name
	desc = dpe_egalitarian_missions.204.desc
	picture = GFX_evt_galactic_senate

	is_triggered_only = yes

	trigger = {
		exists = from
	}

	option = {
		name = dpe_egalitarian_missions.8.A
		custom_tooltip = dpe_egalitarian_missions.8.A.tooltip

		hidden_effect = {
			from = {
				random_list = {
					2 = { #truly authoritarian result
						country_event = { id = dpe_egalitarian_missions.205 days = 30 }
						
						modifier = {
							factor = 2
							any_pop_faction = {
								is_pop_faction_type = totalitarian
								support > 0.6
							}
						}
						modifier = {
							factor = 2
							any_pop_faction = {
								is_pop_faction_type = totalitarian
								support > 0.4
							}
						}
						modifier = {
							factor = 0.5
							any_pop_faction = {
								is_pop_faction_type = totalitarian
								support < 0.25
							}
						}
					}
					2 = { #authoritarian result contested
						country_event = { id = dpe_egalitarian_missions.206 days = 30 }
					}
				}
			}
		}

		ai_chance = {
			factor = 2
			modifier = {
				factor = 2
				from = { has_country_flag = dpe_auth_elections_positive_outcome }
			}
			modifier = {
				factor = 0.5
				any_pop_faction = {
					is_pop_faction_type = progressive
					faction_approval < @cc_faction_danger_number
				}
			}
			modifier = {
				factor = 0.5
				any_pop_faction = {
					is_pop_faction_type = progressive
					support > 0.5
				}
			}
			modifier = {
				factor = 0.8
				has_ethic = ethic_egalitarian
			}
			modifier = {
				factor = 0.5
				has_ethic = ethic_fanatic_egalitarian
			}
			modifier = {
				factor = 2
				from = {
					relative_power = {
						who = root
						value > equivalent
					}
				}
			}
			modifier = {
				factor = 0.5
				from = {
					relative_power = {
						who = root
						value < equivalent
					}
				}
			}
			modifier = {
				factor = 2
				from = {
					has_defensive_pact = root
				}
			}
		}
	}
	option = {
		name = dpe_egalitarian_missions.8.B
		custom_tooltip = dpe_egalitarian_missions.8.B.tooltip

		hidden_effect = {
			from = {
				random_list = {
					1 = { #truly authoritarian result
						country_event = { id = dpe_egalitarian_missions.207 days = 30 }

						modifier = {
							factor = 2
							any_pop_faction = {
								is_pop_faction_type = totalitarian
								support > 0.6
							}
						}
						modifier = {
							factor = 2
							any_pop_faction = {
								is_pop_faction_type = totalitarian
								support > 0.4
							}
						}
						modifier = {
							factor = 0.5
							any_pop_faction = {
								is_pop_faction_type = totalitarian
								support < 0.25
							}
						}
					}
					1 = { #result contra auth wishes
						country_event = { id = dpe_egalitarian_missions.208 days = 30 }
					}
				}
			}
		}

		ai_chance = {
			factor = 1
			modifier = {
				factor = 3
				from = {
					OR = {
						has_country_flag = dpe_auth_elections_positive_outcome_risk
						has_country_flag = dpe_auth_elections_negative_outcome
					}
				}
			}
		}
	}
}


#They complied, good result
country_event = {
	id = dpe_egalitarian_missions.205
	title = dpe_egalitarian_missions.205.name
	desc = dpe_egalitarian_missions.205.desc
	picture = GFX_evt_arguing_senate
	
	is_triggered_only = yes

	trigger = {
		exists = from
	}

	option = {
		name = dpe_egalitarian_missions.9.option

		add_modifier = {
			modifier = dpe_auth_held_successful_election
			years = 5
		}
		hidden_effect = {
			from = {
				country_event = { id = dpe_egalitarian_missions.91 }
			}
		}
	}
}

#They complied, there is some dissent
country_event = {
	id = dpe_egalitarian_missions.206
	title = dpe_egalitarian_missions.206.name
	desc = dpe_egalitarian_missions.206.desc
	picture = GFX_evt_arguing_senate
	
	is_triggered_only = yes

	trigger = {
		exists = from
	}

	option = {
		name = dpe_egalitarian_missions.10.option

		add_modifier = {
			modifier = dpe_auth_held_election
			years = 5
		}
		random_pop_faction = {
			limit = {
				is_pop_faction_type = progressive
			}
			add_modifier = {
				modifier = dpe_sham_elections
				years = 5
			}
		}
		hidden_effect = {
			from = {
				country_event = { id = dpe_egalitarian_missions.101 }
			}
		}
	}
}

#Didn't comply, authoritarian result anyway
country_event = {
	id = dpe_egalitarian_missions.207
	title = dpe_egalitarian_missions.207.name
	desc = dpe_egalitarian_missions.207.desc
	picture = GFX_evt_arguing_senate
	
	is_triggered_only = yes

	trigger = {
		exists = from
	}

	option = {
		name = dpe_egalitarian_missions.11.option

		add_modifier = {
			modifier = dpe_auth_held_successful_election
			years = 5
		}
		hidden_effect = {
			from = {
				country_event = { id = dpe_egalitarian_missions.111 }
			}
		}
	}
}


#They didn't comply, the result is egalitarian
country_event = {
	id = dpe_egalitarian_missions.208
	title = dpe_egalitarian_missions.208.name
	desc = dpe_egalitarian_missions.208.desc
	picture = GFX_evt_arguing_senate
	
	is_triggered_only = yes

	trigger = {
		exists = from
	}

	option = {
		name = dpe_egalitarian_missions.12.option

		add_modifier = {
			modifier = dpe_auth_held_election
			years = 5
		}
		hidden_effect = {
			from = {
				country_event = { id = dpe_egalitarian_missions.121 }
			}
		}
	}
}
